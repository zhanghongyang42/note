# 实现图

![aa](picture/aa.png)

# 推荐UI

首页推荐：

首页推荐展示位置?

首页推荐展示方式，滚动，翻页，固定数量?

首页推荐数量?



购物车推荐：

购物车推荐展示位置？

首页推荐展示方式，滚动，翻页，固定数量?

首页推荐数量?



# 推荐算法

购物车推荐 使用关联规则 的FP-growth 算法：即通过订单详情找出最可能被一起购买的商品，进行推荐



首页推荐可以使用多路召回，然后进行排序的混合推荐，第一期可以使用协同过滤：即通过用户行为找出用户最感兴趣的相似商品，进行推荐。



# 技术实现

使用 spark-mllib 来实现上述两个算法。



# 所需数据

FP-growth 所需订单详情数据，现在已经在数仓中了

协同过滤需要用户行为数据，计算隐式得分，用户行为部分已经在数仓中了，还要再加工收藏加购行为数据。



# 推荐服务

一期：实现初步的推荐功能。

二期：进行粗排，精排，重排的优化迭代。



问题：

1.上下架，配送区匹配，研究所商家匹配等过滤条件在哪里进行过滤，是否还有其他条件。

2.当推荐商品数据不够时，默认商品候补规则是什么？



下面是一些可能的方案，仅供参考

```
FP-growth 数据库中存储商品id（key）和其对应的商品id列表（ids）。ids列表数量为暂定为10。
推荐服务接收 key。从数据库中查出ids（5个）。如果数据库查不到商品key，采用默认推荐商品。如果ids过期或者补全数据时查不到超过5个时，采用默认推荐商品，否则错位返回ids即可。
通过es或者现有商品展示的逻辑，返回给前端。不符合要求的用默认商品（5个）补全(被下单最多的商品),要保证默认商品的可以正确展示。

ALS协同过滤的结果 用户id及其对应的商品id列表 存储在数据库中，ids列表数量为暂定为100。
推荐服务接收用户id 。从数据库中查出ids（暂定5个），如果数据库查不到商品用户id，采用默认推荐商品。
```



# 部署上线

采取离线训练，离线预测的方式进行部署。

预测好的推荐结果存储在线上数据库中，被推荐服务调用，展示给前端。



# 时间安排

待调整。



数仓加工数据：1周左右

FP-growth 开发 ：2周左右

ALS 开发：2周左右

推荐服务前端开发：1周左右

测试联调上线：1-2周















