# 数仓

### 行为数据

*给神策提埋点需求，保存搜索结果的前20个商品。*

```
where：
current_page：首页。
search_type：搜索框搜索，精确搜索。
search_limit：搜全站。
key_word_type：商品信息。
```

```
what：
搜索时间
用户id
关键词
position_number位置序号
goods_id商品ID
goods_name商品名称
specification规格
brand品牌
supplier_id商家ID
```

神策数据拿到3-6个月的 搜索数据。

通过es接口，拿关键词找到前20个商品。

还有其他日志行为表，尽量拿到。



### 业务数据

业务数据的宽表已经做好。可以按照宽表需求搭建一个小数仓。

基本特征都可以直接从业务表中获取。组合特征需要以上述神策数据当中间表关联出来。



# 模型

数据量确定：至少3个月数据，估计400万条。

搜索排序模型：GBDT+LR

读数据，特征工程，模型训练，pipeline，pmml，模型离线评价。



# 上线

对es搜索结果排序。



接收请求。

读取hbase宽表。宽表这尽量多处理数据，方便直接拿。

处理数据，保证训练数据和预测数据的同一性。

web读取pmml，预测。

人工规则调整排序，热搜，曾经购买过。

返回结果。



# 评价

埋点进行在线评价。神策现有埋点数据应该是满足的，具体需要和神策沟通。



搜索点击转化率。

点击在列表位置均值。

























































